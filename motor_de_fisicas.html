



<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copiar al portapapeles">
      
        <meta name="lang:clipboard.copied" content="Copiado al portapapeles">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No se encontraron documentos">
      
        <meta name="lang:search.result.one" content="1 documento encontrado">
      
        <meta name="lang:search.result.other" content="# documentos encontrados">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>Físicas - Videojuegos para Dispositivos Móviles</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/application.0284f74d.css">
      
        <link rel="stylesheet" href="assets/stylesheets/application-palette.01803549.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
      <script src="assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#motores-de-fisicas" tabindex="1" class="md-skip">
        Saltar a contenido
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="Videojuegos para Dispositivos Móviles" class="md-header-nav__button md-logo">
          
            <img src="imagenes/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Videojuegos para Dispositivos Móviles
            </span>
            <span class="md-header-nav__topic">
              
                Físicas
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Teclee para comenzar búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="Videojuegos para Dispositivos Móviles" class="md-nav__button md-logo">
      
        <img src="imagenes/logo.png" width="48" height="48">
      
    </a>
    Videojuegos para Dispositivos Móviles
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="index.html" title="Presentación" class="md-nav__link">
      Presentación
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="videojuegos_para_moviles.html" title="Introducción a los videojuegos móviles" class="md-nav__link">
      Introducción a los videojuegos móviles
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Fundamentos de los motores
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Fundamentos de los motores
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="fundamentos-motores.html" title="Escena y nodos" class="md-nav__link">
      Escena y nodos
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Físicas
      </label>
    
    <a href="motor_de_fisicas.html" title="Físicas" class="md-nav__link md-nav__link--active">
      Físicas
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#componentes-del-motor-de-fisicas" title="Componentes del motor de físicas" class="md-nav__link">
    Componentes del motor de físicas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cuerpos-fisicos" title="Cuerpos físicos" class="md-nav__link">
    Cuerpos físicos
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tipos-de-cuerpos" title="Tipos de cuerpos" class="md-nav__link">
    Tipos de cuerpos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#forma-de-los-cuerpos" title="Forma de los cuerpos" class="md-nav__link">
    Forma de los cuerpos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propiedades-de-los-cuerpos" title="Propiedades de los cuerpos" class="md-nav__link">
    Propiedades de los cuerpos
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simulacion-fisica" title="Simulación física" class="md-nav__link">
    Simulación física
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fuerza-y-masa" title="Fuerza y masa" class="md-nav__link">
    Fuerza y masa
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torque-y-momento-de-inercia" title="Torque y momento de inercia" class="md-nav__link">
    Torque y momento de inercia
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acumulador-de-fuerzas" title="Acumulador de fuerzas" class="md-nav__link">
    Acumulador de fuerzas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aplicacion-de-fuerzas" title="Aplicación de fuerzas" class="md-nav__link">
    Aplicación de fuerzas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aplicacion-de-un-par-de-fuerzas-torque" title="Aplicación de un par de fuerzas (torque)" class="md-nav__link">
    Aplicación de un par de fuerzas (torque)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#impulsos" title="Impulsos" class="md-nav__link">
    Impulsos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#velocidad" title="Velocidad" class="md-nav__link">
    Velocidad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#posicion" title="Posición" class="md-nav__link">
    Posición
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deteccion-de-colisiones" title="Detección de colisiones" class="md-nav__link">
    Detección de colisiones
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#colision-con-un-punto-del-mundo" title="Colisión con un punto del mundo" class="md-nav__link">
    Colisión con un punto del mundo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trazado-de-rayos" title="Trazado de rayos" class="md-nav__link">
    Trazado de rayos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#colisiones-entre-cuerpos" title="Colisiones entre cuerpos" class="md-nav__link">
    Colisiones entre cuerpos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sensores" title="Sensores" class="md-nav__link">
    Sensores
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#layering" title="Layering" class="md-nav__link">
    Layering
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="sprites_e_interaccion.html" title="_Sprites_" class="md-nav__link">
      _Sprites_
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="escenario_y_fondos.html" title="Fondo y _scroll_" class="md-nav__link">
      Fondo y _scroll_
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Motores para  móviles
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Motores para  móviles
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="spritekit.html" title="SpriteKit" class="md-nav__link">
      SpriteKit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="scenekit.html" title="SceneKit" class="md-nav__link">
      SceneKit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="cocos2d-x.html" title="Cocos2d-x" class="md-nav__link">
      Cocos2d-x
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="unity.html" title="Unity" class="md-nav__link">
      Unity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="box2d.html" title="Box2D" class="md-nav__link">
      Box2D
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="mandos.html" title="Controles del videojuego" class="md-nav__link">
      Controles del videojuego
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="adaptacion_a_moviles.html" title="Adaptación a diferentes dispositivos" class="md-nav__link">
      Adaptación a diferentes dispositivos
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="redes_sociales.html" title="Logros y marcadores" class="md-nav__link">
      Logros y marcadores
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#componentes-del-motor-de-fisicas" title="Componentes del motor de físicas" class="md-nav__link">
    Componentes del motor de físicas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cuerpos-fisicos" title="Cuerpos físicos" class="md-nav__link">
    Cuerpos físicos
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tipos-de-cuerpos" title="Tipos de cuerpos" class="md-nav__link">
    Tipos de cuerpos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#forma-de-los-cuerpos" title="Forma de los cuerpos" class="md-nav__link">
    Forma de los cuerpos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propiedades-de-los-cuerpos" title="Propiedades de los cuerpos" class="md-nav__link">
    Propiedades de los cuerpos
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simulacion-fisica" title="Simulación física" class="md-nav__link">
    Simulación física
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fuerza-y-masa" title="Fuerza y masa" class="md-nav__link">
    Fuerza y masa
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torque-y-momento-de-inercia" title="Torque y momento de inercia" class="md-nav__link">
    Torque y momento de inercia
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acumulador-de-fuerzas" title="Acumulador de fuerzas" class="md-nav__link">
    Acumulador de fuerzas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aplicacion-de-fuerzas" title="Aplicación de fuerzas" class="md-nav__link">
    Aplicación de fuerzas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aplicacion-de-un-par-de-fuerzas-torque" title="Aplicación de un par de fuerzas (torque)" class="md-nav__link">
    Aplicación de un par de fuerzas (torque)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#impulsos" title="Impulsos" class="md-nav__link">
    Impulsos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#velocidad" title="Velocidad" class="md-nav__link">
    Velocidad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#posicion" title="Posición" class="md-nav__link">
    Posición
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deteccion-de-colisiones" title="Detección de colisiones" class="md-nav__link">
    Detección de colisiones
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#colision-con-un-punto-del-mundo" title="Colisión con un punto del mundo" class="md-nav__link">
    Colisión con un punto del mundo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trazado-de-rayos" title="Trazado de rayos" class="md-nav__link">
    Trazado de rayos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#colisiones-entre-cuerpos" title="Colisiones entre cuerpos" class="md-nav__link">
    Colisiones entre cuerpos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sensores" title="Sensores" class="md-nav__link">
    Sensores
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#layering" title="Layering" class="md-nav__link">
    Layering
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="motores-de-fisicas">Motores de físicas<a class="headerlink" href="#motores-de-fisicas" title="Permanent link">&para;</a></h1>
<p>Un tipo de juegos que ha tenido una gran proliferación en el mercado de aplicaciones para móviles son aquellos juegos basados en físicas. Estos juegos son aquellos en los que el motor realiza una simulación física de los objetos en pantalla, siguiendo las leyes de la cinemática y la dinámica. Es decir, los objetos de la pantalla están sujetos a gravedad, cada uno de ellos tiene una masa, y cuando se produce una colisión entre ellos se produce una fuerza de reacción que dependerá de su velocidad y su masa. El motor de físicas se
encarga de realizar toda esta simulación, y nosotros sólo deberemos encargarnos de proporcionar las propiedades de los objetos del mundo. </p>
<p>Uno de los juegos que más se ha popularizado, cuya mecánica está basada casi al completo en físicas es Angry Birds (desarrollado por <a href="http://www.rovio.com/games">Rovio</a>). </p>
<p><img alt="Angry Birds, implementado con Box2D" src="imagenes/fisicas/box2d_angry.jpg" /></p>
<h2 id="componentes-del-motor-de-fisicas">Componentes del motor de físicas<a class="headerlink" href="#componentes-del-motor-de-fisicas" title="Permanent link">&para;</a></h2>
<p>Los componentes básicos que nos aporta un motor de físicas son los siguientes:</p>
<ul>
<li>
<p><code>Body</code>: Representa un cuerpo rígido. Estos son los tipos de objetos que tendremos en el mundo físico simulado. Cada cuerpo tendrá una posición y velocidad. Los cuerpos se verán afectados por la gravedad del mundo, y por la interacción con los otros cuerpos. Cada cuerpo tendrá una serie de propiedades físicas, como su masa, su centro de gravedad, su coeficiente de fricción o su forma (<em>shape</em>).</p>
</li>
<li>
<p><code>Shape</code>: Una de las principales características que deberemos tener en cuenta de los cuerpos físicos es su <em>forma</em>. Es importante destacar que el aspecto gráfico de los nodos se define de forma independiente de la <em>forma</em> que tendrá en el mundo físico, pero deberemos intentar que sean lo más parecidos posibles.</p>
</li>
<li>
<p><code>Joint</code>: Nos permite definir uniones entre diferentes cuerpos. Por ejemplo, podemos hacer que un cuerpo esté conectado a otro mediante un resorte, o que pueda moverse sólo en un determinado eje. </p>
</li>
<li>
<p><code>World</code>: Representa el mundo físico en el que tendrá lugar la simulación. A él se añadirán todos los cuerpos y se encargará de realizar la simulación física sobre ellos, aplicando las correspondientes fuerzas y actualizando su velocidad y posición en el mundo. Una de las principales propiedades del mundo es la gravedad.</p>
</li>
</ul>
<h2 id="cuerpos-fisicos">Cuerpos físicos<a class="headerlink" href="#cuerpos-fisicos" title="Permanent link">&para;</a></h2>
<p>Vamos en primer lugar a estudiar los diferentes tipos de cuerpos y sus porpiedades.</p>
<h3 id="tipos-de-cuerpos">Tipos de cuerpos<a class="headerlink" href="#tipos-de-cuerpos" title="Permanent link">&para;</a></h3>
<p>En los motores de físicas encontraremos tres tipos diferentes de cuerpos:</p>
<ul>
<li><strong>Dinámicos</strong>: Están sometidos a las leyes físicas, y tienen una masa concreta y finita. Estos cuerpos se ven afectados por la gravedad y por la interacción con los demás cuerpos.</li>
<li><strong>Estáticos</strong>: Son cuerpos que permanecen siempre en la misma posición. Equivalen a cuerpos con masa infinita. Por ejemplo, podemos hacer que el escenario sea estático. Es importante no mover aquellos cuerpos que hayan sido marcados como estáticos, ya que el motor podría no responder de forma correcta (éste realiza diferentes optimizaciones que asumen que no se van a mover).</li>
<li><strong>Cinemáticos</strong>: Al igual que los cuerpos estáticos tienen masa infinita y no se ven afectados por otros cuerpos ni por la gravedad. Sin embargo, en esta caso no tienen una posición fija, sino que podemos moverlos por el mundo, y podemos darles una velocidad fija. Nos son útiles por ejemplo para proyectiles.</li>
</ul>
<p><img alt="Tipos de cuerpos" src="imagenes/fisicas/box2d_cuerpos.jpg" /></p>
<h3 id="forma-de-los-cuerpos">Forma de los cuerpos<a class="headerlink" href="#forma-de-los-cuerpos" title="Permanent link">&para;</a></h3>
<p>Dependiendo de si tenemos un motor 2D o 3D, las formas de los cuerpos del motor físico serán distintas. Según la forma de los cuerpos, será para el motor más o menos complejo calcular las colisiones entre ellos. A continuación mostramos, <strong>ordenadas de menor a mayor complejidad</strong>, las formas que encontramos habitualmente en un motor de físicas 2D:</p>
<ul>
<li>
<p><strong>Círculos</strong>. Es la forma más sencilla. Se crea simplemente indicando su centro y su radio, y el cálculo de colisiones con ellos es muy eficiente.</p>
</li>
<li>
<p><strong>Polígonos</strong>. Nos permite crear formas arbitrarias convexas. Es importante destacar que los polígonos siempre deberán ser <strong>convexos y cerrados</strong>. El cálculo de colisiones con formas cóncavas es demasiado complejo para el motor de físicas. Un tipo de polígono muy habitual será la forma de <em>caja</em>, muchas veces el motor nos dará atajos para crear dicha forma.</p>
</li>
<li>
<p><strong>Formas compuestas</strong>. Si ninguno de los tipos anteriores de formas se adapta a nuestras necesidades, como por ejemplo en el caso de necesitar una forma cóncava, podemos definir la forma del cuerpo como una composición de formás básicas. Esto será útil para cuerpos dinámicos con formas complejas.</p>
</li>
<li>
<p><strong>Aristas</strong>. Las aristas (<em>edges</em>) son segmentos de línea que normalmente se utilizan para construir la geometría del escenario estático, que podrá tener una forma arbitraria. Este tipo de cuerpo y el siguiente, por poder presentar <em>concavidades</em>, sólo podrá ser utilizado para cuerpos <em>estáticos</em>. El cálculo de colisiones entre dos cuerpos cóncavos es demasiado complejo, por lo que no debe haber cuerpos dinámicos con esas formas (el motor necesita comprobar las colisiones entre pares de cuerpos dinámicos, pero nunca entre dos cuerpos estáticos, al no poder moverse). </p>
</li>
<li>
<p><strong>Cadenas</strong>. Las cadenas nos permiten unir varias aristas para así definir la geometría estática del escenario y evitar que se puedan producir "baches" en las juntas entre diferentes aristas.</p>
</li>
</ul>
<p>En el caso 3D tenemos:</p>
<ul>
<li>
<p><strong>Esferas</strong>. Es la forma más sencilla en este caso. Dado el centro y el radio de la esfera, para saber si colisiona con otra simplemente tendremos que calculas si la distancia entre sus centros es menor que la suma de sus radios.</p>
</li>
<li>
<p><strong>Cajas</strong>. En el caso 3D, en el segundo lugar de complejidad encontramos las cajas. Dependiendo del motor, podríamos encontrar tras este tipo otras clases de formas geométricas predefinidas, como cilindros y conos.</p>
</li>
<li>
<p><strong>Maya convexa</strong>. Si en el motor gráfico tenemos una maya 3D, podemos utilizar como forma física asociada un recubrimiento convexo (<em>convex hull</em>) de dicha maya. Es decir, cogemos la misma forma pero eliminando las concavidades.</p>
</li>
<li>
<p><strong>Formas compuestas</strong>. En algunos casos no podemos eliminar las concavidades de un cuerpo físico, pensemos por ejemplo en la forma de una silla, con sus patas, respaldo y asiento. En estos casos, si necesitamos que dicho cuerpo se comporte como dinámico, podemos crear su forma como una composición de formas cóncavas de los tipos anteriores (por ejemplo, una caja por cada pata, otra para el asiento, y otra para el respaldo).</p>
</li>
<li>
<p><strong>Maya cóncava</strong>. El uso de mayas cóncavas, al igual que ocurría en el caso 2D con los <em>edges</em> y cadenas, queda reservado exclusivamente a los cuerpos estáticos. Puede utilizarse, por ejemplo, para definir la geometría física del escenario estático del juego.</p>
</li>
</ul>
<h3 id="propiedades-de-los-cuerpos">Propiedades de los cuerpos<a class="headerlink" href="#propiedades-de-los-cuerpos" title="Permanent link">&para;</a></h3>
<p>Los cuerpos y tienen una serie de propiedades que nos permiten definir su comportamiento en la simulación física. Hemos hablado sobre la forma de los cuerpos. Vamos a ver ahora otras propiedades físicas que podemos configurar:</p>
<ul>
<li>
<p><strong>Masa</strong>. La masa determinará <em>cuánta</em> fuerza deberemos aplicar al objeto para producir una aceleración. Cuanto mayor sera la masa, más nos costará modificar su velocidad al aplicar una fuerza. Cabe destacar el caso extremos de los cuerpos estáticos o cinemáticos, que tienen masa infinita. Es decir, las fuerzas no tienen efecto sobre ellos.</p>
</li>
<li>
<p><strong>Centro de masas</strong>. Podemos establecer qué punto será el centro de masas del objeto. Por defecto será su centro, pero podemos modificarlo. Cuando apliquemos una fuerza en el centro de masas, se producirá una aceleración lineal. Sin embargo, si se aplica una fuerza en otro punto, la aceleración tendrá tanto una componente lineal como angular (el objeto se moverá y girará).</p>
</li>
<li>
<p><strong>Momento de inercia</strong>. Es el equivalente a la masa, pero en el caso de aplicar una fuerza angular. Nos da una indicación sobre <em>cuánto</em> nos cuesta girar un objeto. Los objetos que tienen su masa concentrada alrededor del centro de masas serán más fáciles de girar que aquellos en los que está distribuida a mayor distancia del centro.</p>
</li>
<li>
<p><strong>Resistencia al aire</strong>. Para cada cuerpo podemos indicar una constante de resistencia al aire (<em>damping</em>), tanto lineal como angular. La resistencia al aire es la fuerza que hará que la velocidad del objeto disminuya, aunque no esté en contacto con ningún otro cuerpo. Cuánta mayor sea la velocidad, más fuerza ejercerá la resistencia al aire para pararlo. Es recomendable indicar una resistencia al aire para que los cuerpos no se muevan (o roten) de forma indefinida.</p>
</li>
<li>
<p><strong>Fricción</strong>. La fricción es la fuerza que hace que un objeto se pare al deslizarse sobre otro, debido a rugosidades de la superficie. A diferencia de la resistencia al aire, esta fuerza sólo se ejercerá cuando dos cuerpos estén en contacto.</p>
</li>
<li>
<p><strong>Restitución</strong>. La restitución nos indica la forma en la que responderá un objeto al colisionar con otro, permitiendo que los objetos permanezcan juntos o reboten. Una restitución <code>0</code> indica que el objeto no rebotará el colisionar, mientras que el valor <code>1</code> indica que al colisionar rebota y en el rebote se restituye toda la velocidad que tenía en el momento previo a la colisión.</p>
</li>
</ul>
<h2 id="simulacion-fisica">Simulación física<a class="headerlink" href="#simulacion-fisica" title="Permanent link">&para;</a></h2>
<p>Una vez vistas las propiedades de los cuerpos del mundo físico, vamos a ver como realiza el motor la simulación.</p>
<p>Es importante destacar que la simulación se realiza de forma discreta. Es decir, en cada iteración del ciclo del juego, se simula la aplicación de las leyes de la cinemática y de la dinámica a todos los cuerpos del mundo, considerando el tiempo transcurrido desde la iteración anterior (<em>delta time</em>), para la actualización de la posición y velocidad de los objetos.</p>
<blockquote>
<p><strong>Recomendación</strong>: En el caso de la simulación física conviene utilizar un <em>delta time</em> fijo, para así obtener resultados predecibles en la simulación (por ejemplo <em>60 fps</em>), independientemente del <em>frame rate</em> del <em>render gráfico</em>, que podría ser variable. Normalmente los motores se encargan de gestionar esto por nosotros. </p>
</blockquote>
<p>Sobre los cuerpos del mundo físico actuarán una serie de fuerzas:</p>
<ul>
<li><strong>Gravedad</strong>. La fuerza de gravedad es una propiedad del mundo físico que podremos alterar, y que por defecto se aplicará sobre todos los cuerpos del mundo, aunque podremos excluir determinados cuerpos de forma manual.</li>
<li><strong>Resistencia al aire</strong>. Dependiendo de la propiedad <em>damping</em> de cada objeto, se aplicará sobre ellos una fuerza de resistencia al aire, proporcional a su velocidad y a su factor de <em>damping</em>, pero en la dirección contraria a su movimient.</li>
<li><strong>Fuerzas de reacción</strong>. Cuando se produzca una colisión entre objetos, se producirá una fuerza de reacción entre ellos, que dependerá de su propiedad de <em>restitución</em>. Según dicha propiedad, esta fuerza hará simplemente que queden paren de moverse, o que reboten.</li>
<li><strong>Fuerzas aplicadas en el código</strong>. Podemos aplicar fuerzas sobre los diferentes cuerpos del mundo, por ejemplo para empujar una caja o lanzar una roca. </li>
</ul>
<p>El motor de simulación física, a partir de las fuerzas aplicadas a los cuerpos y las propiedades de los mismos, calculará la aceleración producida en cada caso. Con ello, aplicando las ecuaciones de la cinemática y de la dinámica actualizará la velocidad y la posición de los mismos. </p>
<p>Tras realizar la actualización, comprobará si se producen <strong>colisiones</strong> entre los cuerpos. En tal caso, deberá resolver la colisión, aplicando la fuerza de reacción correspondiente.</p>
<p>Vamos a ver con mayor detalle la forma en la que se aplican fuerzas e impulsos sobre los cuerpos del mundo.</p>
<h3 id="fuerza-y-masa">Fuerza y masa<a class="headerlink" href="#fuerza-y-masa" title="Permanent link">&para;</a></h3>
<p>Siguiendo la segunda ley de Newton, la fuerza que se debe aplicar sobre un objeto para producir una determinada aceleración se calcula de la siguiente forma:</p>
<div>
<div class="MathJax_Preview">\mathbf{f} = m\mathbf{a}</div>
<script type="math/tex; mode=display">\mathbf{f} = m\mathbf{a}</script>
</div>
<p>Sin embargo, en nuestro motor de físicas lo que realmente nos interesa es conocer la aceleración producida tras aplicar una fuerza, calculada como:</p>
<div>
<div class="MathJax_Preview">\mathbf{a} = \frac{1}{m}\mathbf{f}</div>
<script type="math/tex; mode=display">\mathbf{a} = \frac{1}{m}\mathbf{f}</script>
</div>
<p>Podemos ver que aquí multiplicamos la fuerza por la <strong>inversa de la masa</strong>. Dado que este cálculo es frecuente, para evitar tener que calcular la inversa en cada momento, normalmente los motores almacenan la masa inversa de los cuerpos, en lugar de almacenar la masa.</p>
<p>Almacenar la masa inversa tiene una ventaja importante. Para hacer que un cuerpo sea estático (que no se vea afectado por las fuerzas que sobre él se ejerzan) lo que haremos es dar a ese cuerpo masa infinita. Este valor infinito podría crear dificultades en el código, y la necesidad de tratar casos especiales. Si trabajamos únicamente con masa inversa, bastará con darle un valor <code>0</code> a la masa inversa para hacer el cuerpo estático.</p>
<p>Además de la masa, el motor nos permitirá especificar el centro de masas y el momento de inercia de los cuerpos. El momento de inercia nos permitirá indicar qué par de fuerzas (<em>torque</em>) deberemos ejercer para producir una determinada aceleración angular, de la misma forma que la masa nos indica qué fuerza debemos ejercer para producir una determinada aceleración lineal.</p>
<h3 id="torque-y-momento-de-inercia"><em>Torque</em> y momento de inercia<a class="headerlink" href="#torque-y-momento-de-inercia" title="Permanent link">&para;</a></h3>
<p>El <em>torque</em> <span><span class="MathJax_Preview">\tau</span><script type="math/tex">\tau</script></span> es a la aceleración angular <span><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span> lo que la fuerza es a la aceleración lineal. En este caso, en lugar de tener en cuenta únicamente la masa del objeto, deberemos tener en cuenta su momento de inercia <span><span class="MathJax_Preview">I</span><script type="math/tex">I</script></span>, en el que no sólo tenemos la masa, sino cómo está repartida a lo largo del cuerpo, lo cual influirá en cómo las fuerzas afectarán a la rotación.</p>
<div>
<div class="MathJax_Preview">\tau = I \alpha</div>
<script type="math/tex; mode=display">\tau = I \alpha</script>
</div>
<p>Por ejemplo, si tenemos un objeto con forma de bastón, habrá que hacer menos fuerza para que gire alrededor de su eje principal que alrededor de otro eje. Por lo tanto, el momento de inercia no tendrá siempre el mismo valor para un determinado objeto, sino que dependerá del eje de rotación.</p>
<p>El <em>momento de inercia</em> codifica cómo está repartida la masa del objeto alrededor de su centro. Para simplificar, supongamos que nuestro cuerpo rígido está compuesto de <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> partículas cada una de ellas con una determinada masa <span><span class="MathJax_Preview">m_i</span><script type="math/tex">m_i</script></span>, y situada en una posición <span><span class="MathJax_Preview">(x_i, y_i)</span><script type="math/tex">(x_i, y_i)</script></span> respecto al centro de masas del cuerpo. El momento de inercia se calcularía de la siguiente forma (medido en <span><span class="MathJax_Preview">kg·m</span><script type="math/tex">kg·m</script></span>):</p>
<div>
<div class="MathJax_Preview">I = \sum^{n}_{i=1} m_i \sqrt{x_i^2 + y_i^2}</div>
<script type="math/tex; mode=display">I = \sum^{n}_{i=1} m_i \sqrt{x_i^2 + y_i^2}</script>
</div>
<p>Es decir, este coeficiente no tiene en cuenta sólo la masa, sino también lo alejada que está la masa respecto del centro del centro. De esta forma, hará falta hacer más fuerza para girar un cuerpo cuando la distribución de masa esté alejada del centro.</p>
<blockquote>
<p>Los motores de físicas por defecto calcularán de forma automática tanto el centro de masas como el momento de inercia a partir de la densidad (o masa) y de la forma que hemos asignado al cuerpo, y no necesitaremos establecer estos datos de forma manual a no ser que busquemos un comportamiento distinto.</p>
</blockquote>
<h3 id="acumulador-de-fuerzas">Acumulador de fuerzas<a class="headerlink" href="#acumulador-de-fuerzas" title="Permanent link">&para;</a></h3>
<p>Normalmente sobre un cuerpo actuarán varias fuerzas. Siguiendo el principio de <em>D'Alembert</em>, un conjunto de fuerzas</p>
<div>
<div class="MathJax_Preview">F=\{f_1, f_2, ... f_{|F|}\}</div>
<script type="math/tex; mode=display">F=\{f_1, f_2, ... f_{|F|}\}</script>
</div>
<p>actuando sobre un objeto pueden ser sustituidas por una única fuerza calculada como la suma de las fuerzas de <span><span class="MathJax_Preview">F</span><script type="math/tex">F</script></span>:</p>
<div>
<div class="MathJax_Preview">f = \sum^{|F|}_{i=1} f_i</div>
<script type="math/tex; mode=display">f = \sum^{|F|}_{i=1} f_i</script>
</div>
<p>Para ello, cada objeto contará con un acumulador de fuerzas <span><span class="MathJax_Preview">f</span><script type="math/tex">f</script></span> donde se irán sumando todas las fuerzas que actúan sobre él (gravedad, resistencia al aire, interacción con otros objetos, etc). Cuando llegue el momento de realizar la actualización de posición y velocidad, la aceleración del objeto se calculará a partir de la fuerza que indique dicho acumulador <span><span class="MathJax_Preview">f</span><script type="math/tex">f</script></span>.</p>
<p>Deberemos llevar cuidado con la discretización del tiempo. Si una gran fuerza se aplica durante un periodo de tiempo muy breve (por ejemplo para disparar una bala), si la aceleración producida se extiende a todo el <em>delta time</em> el incremento de velocidad producido puede ser desmesurado. Por este motivo, estas fuerzas que se aplican en un instante puntual de tiempo se tratarán como <strong>impulsos</strong>.</p>
<h3 id="aplicacion-de-fuerzas">Aplicación de fuerzas<a class="headerlink" href="#aplicacion-de-fuerzas" title="Permanent link">&para;</a></h3>
<p>El caso más común de fuerza aplicada a los objetos es la <strong>gravedad</strong>. Si queremos hacer una simulación realista deberíamos aplicar una fuerza que produzca una aceleración de</p>
<div>
<div class="MathJax_Preview">a_{gravedad}=-9.8 \frac{m}{s^2}</div>
<script type="math/tex; mode=display">a_{gravedad}=-9.8 \frac{m}{s^2}</script>
</div>
<p>sobre nuestros objetos en el eje <span><span class="MathJax_Preview">y</span><script type="math/tex">y</script></span> (normalmente se redondea en <span><span class="MathJax_Preview">a_{gravedad}=10</span><script type="math/tex">a_{gravedad}=10</script></span>. Considerando el vector</p>
<div>
<div class="MathJax_Preview">\mathbf{a}_{gravedad} = (0, a_{gravedad})</div>
<script type="math/tex; mode=display">\mathbf{a}_{gravedad} = (0, a_{gravedad})</script>
</div>
<p>tenemos:</p>
<div>
<div class="MathJax_Preview">\mathbf{f}_{gravedad} = \mathbf{a}_{gravedad}m</div>
<script type="math/tex; mode=display">\mathbf{f}_{gravedad} = \mathbf{a}_{gravedad}m</script>
</div>
<p>También se puede tratar como una fuerza la <strong>"resistencia al aire"</strong> (<em>damping</em>) que produce que los objetos vayan frenando y no se muevan indefinidamente. Un modelo simplificado para esta fuerza que se suele utilizar en videojuegos es el siguiente:</p>
<div>
<div class="MathJax_Preview">\mathbf{f}_{resistencia} = -\mathbf{\hat{v}}(k_{damping} |\mathbf{v}| </div>
<script type="math/tex; mode=display">\mathbf{f}_{resistencia} = -\mathbf{\hat{v}}(k_{damping} |\mathbf{v}| </script>
</div>
<p>Donde <span><span class="MathJax_Preview">k_{damping}</span><script type="math/tex">k_{damping}</script></span> es la constante de <em>damping</em> especificada para el cuerpo, y <span><span class="MathJax_Preview">\mathbf{\hat{v}}</span><script type="math/tex">\mathbf{\hat{v}}</script></span> el vector de velocidad normalizado (vector unitario con la dirección de la velocidad). Podemos ver que la fuerza actúa en el sentido opuesto a la velocidad del objeto (lo frena), y con una magnitud proporcional a la velocidad.</p>
<p>A parte de las fuerzas de gravedad, resistencia al aire, y las fuerzas ejercidas entre cuerpos en contacto, también podemos aplicar una fuerza manualmente sobre un determinado cuerpo. A la hora de aplicar una fuerza debemos indicar:</p>
<ul>
<li><strong>Vector de fuerza</strong> a aplicar </li>
<li><strong>Punto del cuerpo</strong> (opcional) donde aplicarla. En caso de no especificarlo, por defecto se considerará que será su centro de masas.</li>
</ul>
<p>Las unidades en las que especificaremos la fuerza son <em>Newtons</em> (<span><span class="MathJax_Preview">N = \frac{kg·m}{s^2}</span><script type="math/tex">N = \frac{kg·m}{s^2}</script></span>).</p>
<p>Si el punto del objeto al que aplicamos la fuerza no es su centro de masas, la fuerza producirá además que el objeto rote (a no ser que en sus propiedades hayamos indicado que no puede rotar).</p>
<h3 id="aplicacion-de-un-par-de-fuerzas-torque">Aplicación de un par de fuerzas (<em>torque</em>)<a class="headerlink" href="#aplicacion-de-un-par-de-fuerzas-torque" title="Permanent link">&para;</a></h3>
<p>Podemos también aplicar un par de fuerzas (<em>torque</em>) para producir una rotación del objeto alrededor de su centro de masas sin producir una traslación. El <em>torque</em> se indica en <span><span class="MathJax_Preview">N·m</span><script type="math/tex">N·m</script></span>.</p>
<h3 id="impulsos">Impulsos<a class="headerlink" href="#impulsos" title="Permanent link">&para;</a></h3>
<p>Los impulsos producen un cambio instantáneo en la velocidad de un objeto. Podemos ver los impulsos respecto a la velocidad como vemos a las fuerzas respecto a la aceleración. Si aplicar una fuerza a un cuerpo produce una aceleración, aplicar un impulso produce un cambio de velocidad. Una diferencia importante es que no puede haber aceleración si no se aplica ninguna fuerza, mientras que si que puede haber velocidad si no se aplican impulsos, un impulso lo que provoca es un cambio en la velocidad. El impulso <span><span class="MathJax_Preview">g</span><script type="math/tex">g</script></span> necesario para producir un cambio de velocidad <span><span class="MathJax_Preview">\Delta v</span><script type="math/tex">\Delta v</script></span> será proporcional a la masa del objeto:</p>
<div>
<div class="MathJax_Preview">\begin{equation}
g = m\Delta v
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
g = m\Delta v
\end{equation}</script>
</div>
<p>Al igual que en el caso de las fuerzas, el cálculo que nos interesará realizar es la obtención del cambio de velocidad a partir del impulso:</p>
<div>
<div class="MathJax_Preview">\begin{equation}
\Delta v = \frac{1}{m}g
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
\Delta v = \frac{1}{m}g
\end{equation}</script>
</div>
<p>Considerando <span><span class="MathJax_Preview">\Delta v = v' - v</span><script type="math/tex">\Delta v = v' - v</script></span>, donde <span><span class="MathJax_Preview">v</span><script type="math/tex">v</script></span> es la velocidad previa a la aplicación del impulso, y <span><span class="MathJax_Preview">v'</span><script type="math/tex">v'</script></span> es la velocidad resultante, tenemos:</p>
<div>
<div class="MathJax_Preview">\begin{equation}
v' = v + \frac{1}{m}g
\end{equation}</div>
<script type="math/tex; mode=display">\begin{equation}
v' = v + \frac{1}{m}g
\end{equation}</script>
</div>
<p>Al igual que en el caso de las fuerzas, al aplicar un impulso también podremos indicar el punto del cuerpo en el que lo aplicamos.</p>
<p>Las unidades en este caso son <span><span class="MathJax_Preview">N·m·s</span><script type="math/tex">N·m·s</script></span> (es decir, <span><span class="MathJax_Preview">kg\frac{m^2}{s}</span><script type="math/tex">kg\frac{m^2}{s}</script></span>).</p>
<h3 id="velocidad">Velocidad<a class="headerlink" href="#velocidad" title="Permanent link">&para;</a></h3>
<p>Además de aplicar fuerzas e impulsos sobre los cuerpos, también podemos consultar o modificar su velocidad directamente. En el caso de la velocidad trabajaremos con <span><span class="MathJax_Preview">\frac{m}{s}</span><script type="math/tex">\frac{m}{s}</script></span>.</p>
<p>Esto puede ser útil en cuerpos de tipo <em>cinemático</em>, en los que las fuerzas no tienen efecto (al tener masa infinita), pero que si que pueden mantener una velocidad constante, como por ejemplo un proyectil.</p>
<p>De la misma forma, también podemos consultar y modificar la velocidad angular. En estos casos las unidades son <span><span class="MathJax_Preview">\frac{radianes}{s}</span><script type="math/tex">\frac{radianes}{s}</script></span>.</p>
<h3 id="posicion">Posición<a class="headerlink" href="#posicion" title="Permanent link">&para;</a></h3>
<p>Dado un cuerpo, cuyo centro de masas está posicionado en <span><span class="MathJax_Preview">\mathbf{p}_0</span><script type="math/tex">\mathbf{p}_0</script></span> y con rotación <span><span class="MathJax_Preview">\Theta</span><script type="math/tex">\Theta</script></span> (matriz de rotación), puede interesarnos determinar la posición de cualquier otro punto del objeto en el mundo. Supongamos que queremos conocer la posición de un punto cuyas coordenadas locales (respecto al centro de masas) son <span><span class="MathJax_Preview">\mathbf{p}_{local}</span><script type="math/tex">\mathbf{p}_{local}</script></span>. La posición global de dicho punto vendrá determinada por:</p>
<div>
<div class="MathJax_Preview">\mathbf{p}_{global} = \Theta \mathbf{p}_{local} + \mathbf{p}_0</div>
<script type="math/tex; mode=display">\mathbf{p}_{global} = \Theta \mathbf{p}_{local} + \mathbf{p}_0</script>
</div>
<p>Para simplificar este cálculo, normalmente los motores nos permitirán convertir las coordenadas locales de un cuerpo, a coordenadas globales del mundo.  </p>
<h2 id="deteccion-de-colisiones">Detección de colisiones<a class="headerlink" href="#deteccion-de-colisiones" title="Permanent link">&para;</a></h2>
<p>Hemos comentado que dentro de la simulación física existen interacciones entre los diferentes objetos del mundo. Encontramos diferentes formas de consultar las colisiones de los objetos del mundo con otros objetos y otros elementos.</p>
<h3 id="colision-con-un-punto-del-mundo">Colisión con un punto del mundo<a class="headerlink" href="#colision-con-un-punto-del-mundo" title="Permanent link">&para;</a></h3>
<p>Un <em>test</em> sencillo consiste en comprobar si la forma de un cuerpo ocupa un determinado punto del mundo. Esto es útil por ejemplo cuando tocamos sobre la pantalla táctil, para comprobar si en el punto sobre el que hemos pulsado hay un determinado objeto. </p>
<p>En el caso de motores 3D, se puede comprobar si hay algún cuerpo dentro de una determinada área del mundo (útil por ejemplo para saber los cuerpos que han sido afectados por una explosión).</p>
<h3 id="trazado-de-rayos">Trazado de rayos<a class="headerlink" href="#trazado-de-rayos" title="Permanent link">&para;</a></h3>
<p>Otro <em>test</em> disponible es el trazado de rayos. Consiste en lanzar un rayo desde una determinada posición del mundo en una determinada dirección y comprobar cuál es el primer objeto del mundo físico con el que impacta. Podremos lanzar un rayo para comprobar si impacta contra un objeto determinado, o bien para obtener una lista de objetos con los que impacta.</p>
<p>Esto es utilizado de forma habitual en casos como los siguientes:</p>
<ul>
<li><em>Disparos</em>. Al ser la bala un objeto extremadamente rápido, no es conveniente simular su movimiento con el motor de físicas, ya que podría producirse el efecto conocido como <em>tunneling</em>, atravesando objetos al dar un gran salto en su posición de una iteración a la siguiente. En este caso es mejor simplemente considerar la bala como algo instantáneo, y encontrar en el mismo momento en que se dispara el objeto con el que impactaría lanzando un rayo.</li>
<li><em>Visibilidad</em>. Si queremos saber si un personaje <em>ve</em> a otro, podremos lanzar un rayo del primero al segundo, y ver si el rayo impacta antes con otro objeto. En tal caso, quiere decir que hay algo que se lo tapa, y por lo tanto no lo verá.</li>
<li><em>Seleccionar objetos en 3D</em>. Cuando pulsamos sobre la pantalla en un juego 3D, no es trivial saber sobre qué objetos estamos tocando, ya que tenemos unas coordenadas 2D del <em>touch</em> en pantalla, pero los objetos del mundo están en un espacio 3D. Podemos para ello lanzar un rayo desde el punto de vista de la cámara hacia la posición en la que estamos tocando en un plano perpendicular a la cámara, y ver con qué objetos impacta.</li>
</ul>
<p>Para lanzar un rayo, normalmente indicaremos:</p>
<ul>
<li>Punto desde el que lanzamos el rayo.</li>
<li>Dirección (<em>vector</em>) en la que lo lanzamos.</li>
<li>Distancia máxima de alcance.</li>
</ul>
<p>Como salida tenemos la siguiente información del punto de impacto:</p>
<ul>
<li><em>Cuerpo</em>: Objeto del mundo sobre el que ha impactado el rayo.</li>
<li><em>Fracción</em>: Tomando como referencia el vector desde el punto inicial al final del rayo, nos indica en qué fracción de dicho vector se encuentra el punto de impacto. </li>
<li><em>Normal</em>: Nos indica la dirección normal de la superficie sobre la que ha impactado el rayo. De esta forma podremos saber si hemos impactado de lado o de frente, y así aplicar distinto nivel de daño en cada caso, o aplicar una fuerza al objeto en la dirección en la que haya recibido el impacto.</li>
</ul>
<h3 id="colisiones-entre-cuerpos">Colisiones entre cuerpos<a class="headerlink" href="#colisiones-entre-cuerpos" title="Permanent link">&para;</a></h3>
<p>Podemos recibir notificaciones cada vez que se produzca un contacto entre objetos del mundo, para así por ejemplo aumentar el daño recibido. Para esto, normalmente deberemos implementar un <em>listener</em> al que nos llegarán avisos de los contactos entre cuerpos.</p>
<p>Cada vez que se produzca un contacto, de éste sabremos:</p>
<ul>
<li><strong>Cuerpos involucrados</strong>. En cada contacto participarán dos cuerpos (A y B), cuyo orden es arbitrario</li>
<li><strong>Velocidad del impacto</strong>. La velocidad relativa a la que han impactado los cuerpos nos permitirá aplicar un diferente nivel de daño según la fuerza del impacto.</li>
<li><strong>Normal del impacto</strong>. También podremos saber en qué dirección se ha producido el impacto. Un choque frontal producirá mas daño que uno con un determinado ángulo.</li>
</ul>
<p>A partir de esta información, el motor resolverá el contacto aplicando la fuerza de reacción oportuna, aunque en ocasiones nos permitirá personalizar la forma en la que se resuelven los contactos.</p>
<p>Como hemos comentado anteriormente, el cálculo de las colisiones y puntos de contacto entre dos cuerpos puede llegar a ser muy complejo, dependiendo de su forma. Por ello, el motor debe optimizar en la medida de los posible la forma de realizar estos cálculos, y no realizar más comprobaciones de las necesarias. </p>
<p>En primer lugar, sólo realizará <strong>comprobaciones de colisión</strong> en las que uno de los cuerpos sea dinámico. Dado que los cuerpos estáticos y cinemáticos no pueden recibir fuerzas de reacción, no tiene sentido calcular colisiones entre ellos si no interviene un cuerpo dinámico. En la siguiente tabla se indican las comprobaciones que se realizan:</p>
<table>
<thead>
<tr>
<th></th>
<th>Estático</th>
<th>Cinemático</th>
<th>Dinámico</th>
</tr>
</thead>
<tbody>
<tr>
<td>Estático</td>
<td>No</td>
<td>No</td>
<td><strong>Si</strong></td>
</tr>
<tr>
<td>Cinemático</td>
<td>No</td>
<td>No</td>
<td><strong>Si</strong></td>
</tr>
<tr>
<td>Dinámico</td>
<td><strong>Si</strong></td>
<td><strong>Si</strong></td>
<td><strong>Si</strong></td>
</tr>
</tbody>
</table>
<p>Además, también podremos personalizar entre qué grupos de cuerpos se realizan las comprobaciones mediante el uso del <em>layering</em>, como veremos más adelante, para filtrar aún más las comprobaciones a realizar.</p>
<h3 id="sensores">Sensores<a class="headerlink" href="#sensores" title="Permanent link">&para;</a></h3>
<p>En el punto anterior hemos visto cómo detectar colisiones entre cuerpos que producen una respuesta (fuerza de reacción). En algunos casos nos interesa que en el motor de físicas se detecten contactos con un cuerpo, pero que no produzcan una respuesta en la simulación física. </p>
<p>Por ejemplo, podríamos tener una zona en la que al entrar algún cuerpo queramos que se abra alguna puerta. Esto podemos conseguirlo mediante sensores. </p>
<p>Al ser un sensor, otros objetos atravesarán dicho cuerpo, pero recibiremos notificaciones cuando esto ocurra.</p>
<p>En el caso de los <strong>sensores</strong> las comprobaciones cambian ligeramente respecto a las <strong>colisiones</strong>. En el caso de las colisiones no tenía sentido hacer la comprobación entre dos cuerpos cinemáticos, ya que no se les va a aplicar fuerza de reacción para resolver la colisión, pero si que nos puede interesar saber si están en contacto. Por lo tanto, en caso de los sensores normalmente se amplian las comprobaciones a realizar:</p>
<table>
<thead>
<tr>
<th></th>
<th>Estático</th>
<th>Cinemático</th>
<th>Dinámico</th>
</tr>
</thead>
<tbody>
<tr>
<td>Estático</td>
<td>No</td>
<td><strong>Si</strong></td>
<td><strong>Si</strong></td>
</tr>
<tr>
<td>Cinemático</td>
<td><strong>Si</strong></td>
<td><strong>Si</strong></td>
<td><strong>Si</strong></td>
</tr>
<tr>
<td>Dinámico</td>
<td><strong>Si</strong></td>
<td><strong>Si</strong></td>
<td><strong>Si</strong></td>
</tr>
</tbody>
</table>
<h3 id="layering"><em>Layering</em><a class="headerlink" href="#layering" title="Permanent link">&para;</a></h3>
<p>El <em>layering</em> es una característica de los motores de física que nos pemitirá indicar qué comprobaciones de colisión debe hacer el motor.</p>
<p>Para ello, se definen diferentes <em>capas</em> o categorías de objetos. Por ejemplo <em>"Personaje"</em>, <em>"Enemigos"</em> y <em>"Balas"</em>. Podemos asignar a cada cuerpo del motor, una de estas categorías.</p>
<p>Con esto, podemos proporcionar una matriz que nos indique qué categorías se comprueban con cuáles otras. Por ejemplo, en el caso anterior podríamos tener algo como:</p>
<table>
<thead>
<tr>
<th></th>
<th>Personaje</th>
<th>Enemigos</th>
<th>Balas</th>
</tr>
</thead>
<tbody>
<tr>
<td>Personaje</td>
<td>No</td>
<td><strong>Si</strong></td>
<td><strong>Si</strong></td>
</tr>
<tr>
<td>Enemigos</td>
<td><strong>Si</strong></td>
<td>No</td>
<td><strong>Si</strong></td>
</tr>
<tr>
<td>Balas</td>
<td><strong>Si</strong></td>
<td><strong>Si</strong></td>
<td>No</td>
</tr>
</tbody>
</table>
<p>En este caso, nos interesa saber si un enemigo toca a nuestro personaje (nos mata), o si una bala toca al personaje o a un enemigo (lo mataría), pero no nos interesa saber si un enemigo toca a otro, ni si una bala toca a otra. Modificando esta matriz podríamos conseguir de forma sencilla por ejemplo que una bala mate a los enemigos pero no a nuestro personaje.</p>
<p>En algunos motores el <em>layering</em> se implemente como una matriz a nivel global, mientras que en otros se trata de una máscara binaria para cada cuerpo, en la que indicamos con qué categorías podría colisionar. </p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="fundamentos-motores.html" title="Escena y nodos" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Anterior
                </span>
                Escena y nodos
              </span>
            </div>
          </a>
        
        
          <a href="sprites_e_interaccion.html" title="_Sprites_" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Siguiente
                </span>
                _Sprites_
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/application.245445c6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>